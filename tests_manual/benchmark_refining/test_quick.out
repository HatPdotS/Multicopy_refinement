================================================================================
QUICK OPTIMIZER TEST
================================================================================

Testing refinement reload...
Found 109 link definitions
  Initial refinement created
    data_file: /das/work/p17/p17490/Peter/Library/multicopy_refinement/scientific_testing/data/1A0F/1A0F.mtz
    pdb: /das/work/p17/p17490/Peter/Library/multicopy_refinement/scientific_testing/data/1A0F/1A0F_shaken.pdb
    target_weights: {'xray': 1.0, 'restraints': 1.0, 'adp': 0.3}
Found 109 link definitions
  Reloaded refinement created
✓ Reload test passed

Testing LBFGS with target=xyz, nsteps=2
  Step 1: X-ray work=100.1430, test=179.1507, Rwork=0.2768, Rfree=0.2708
  Step 2: X-ray work=75.7753, test=136.1689, Rwork=0.2515, Rfree=0.2512
✓ LBFGS test passed
Found 109 link definitions

Testing Adam with target=xyz, nsteps=2
  Step 1: X-ray work=108.5585, test=129.6081, Rwork=0.3056, Rfree=0.3128
  Step 2: X-ray work=103.5601, test=126.5083, Rwork=0.2966, Rfree=0.3027
✓ Adam test passed

================================================================================
ALL TESTS PASSED! ✓
================================================================================

You can now run the full benchmark with:
  sbatch test_optimizers.py
